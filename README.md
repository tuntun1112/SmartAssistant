# 高中自主學習-智慧小助理專題實作

## 作者
- 復旦高中 371 班 張宸碩
- 復旦高中 367 班 詹秉豐

## 摘要

我們將會以一張Esp32S3開發板以及一張Orange Pi One 512M為核心，製作一個可以24小時擺放在房間書桌上的智能小助理，可以和使用者交互、分析行為或是執行動作，作為我們高中自主學習跨學期專題。


## 功能描述

### 啟動、休眠與喚醒
- 首次開機：通電後ESP32首先驅動螢幕顯示開機動畫（小助理的表情動畫），在開機動畫顯示期間嘗試與所有零件建立連線（例如測試各種外設正常與否，是否可以讀取到資訊，還有等待我們的orange pi one中的Linux開機），如果有問題就顯示出來，沒有問題就進入主畫面。
- 休眠與喚醒：當偵測到無人狀態（PIR 感測器無訊號，動作偵測無人）時進入待機（並非esp的休眠模式，而是單純的螢幕顯示暫停，動作分析暫停、等等…），喚醒部分則將使用紅外感應器以及觸控螢幕的觸控感測，讓他們在檢測有人接近時（例如紅外有訊號或者有人觸摸了螢幕）就會重新喚醒，來到正常服務狀態。

### 主要功能
- 常駐小時鐘：啟動成功後，開機動畫顯示完畢，顯示打招呼的動畫和打招呼字幕顯示，然後進入主畫面開始顯示當前時間，變成有點類似桌上時鐘的樣子。
#### 補充主螢幕顯示說明
>- 中間大字顯示目前時間
>- 左上角顯示目前動作辨識檢測到的動作狀態
>- 右上角顯示當前地區的天氣、降雨機率、氣溫（如果有連線上氣候API）
>- 左下角是不是會有小助理表情探頭出來看看再縮回去的動畫
>- 右下角顯示目前的Wifi連接情況（是否連線以及訊號強度等等）

- 基礎交互：在已經處於喚醒開機的狀態下（處於小時鐘模式），如果使用者和小助理產生了互動，例如搖晃及輕拍（加速度感應器及陀螺儀數值突然大幅變動）、按壓（微動感測器按壓），就會有小助理表情反饋（螢幕表情動畫）。

- 對話功能：本功能需要Wifi處於連線情況,而，當使用者長壓小助理一段時間（微動檢測到按壓），會嘗試連結到我們的後端LLMAPI，連線不到則提示並退回主畫面，連線到將會進入對話模式，利用麥克風接收用戶說話，傳送到API處理後生成音訊回答再回傳回來，利用揚聲器播放，以及顯示回答字幕，還有回答時的說話表情動畫。

- 智能動作辨識：在已經處於喚醒並且在時鐘狀態下，小助理將會開始進行動作辨識（使用orange pi one上的鏡頭和動作辨識模型），識別使用者現在在桌上做的事（例如唸書，玩遊戲....之類的行為）然後根據做的行為進行相應任務（例如提醒使用者手機滑太久了要讀書、提醒使用者站立活動、提醒喝水....），以及將統計數據下來，


## 準備材料
- 開發板ESP32-S3-N16R8-WROOM-1
- 開發版Orange pi one 512M
- 攝像頭：GC2035(安裝於Orange pi的鏡頭接口)
- 螢幕：ILI9488(含XPT2046觸控)
- 三軸加速度傳感器：MPU-6050(GY-521)
- 麥克風：INMP441
- 聲音模塊：MAX98357
- 揚聲器：1個3W4Ω小型全頻揚聲器（已經安裝於Max98357）
- 時鐘模塊：DS3231
- SD卡模塊（具有多張不同容量的記憶卡）
- PIR被動紅外人體感測器：HC-SR505
- 微動感測器（如果實作重量太大可能會換成按壓力道需要較深的按鈕）


## 開發環境
- Windows 11 Pro 24H2
- Visual studio cuda
- ESP-IDF v5.4


## 開發過程使用的AI工具
### 內嵌工具
- Claude Code (MCP:Zen)
- GitHub Copilot Pro
### 外部工具
- ChatGPT (codex)
- Claude
- Gemini
- Grok
- DeepSeek